import{c as H,ay as ne,h as D,k as J,p as U,D as C,N as $,Q as K,E as T,F as u,L as _e,z as d,K as ve,_ as Z,n as xe,d as be,ak as ye,aK as Ce,l as Q,r as h,w as le,t as Se,$ as t,W as X,X as Y,H as B,O as q,G as ae,aL as Ve,M as ee,as as $e,aM as fe,av as Ne,an as Re,ax as De,aN as Te,ab as Ee,C as Ue,s as Ae,aO as j,a6 as M,at as Le,au as Fe,u as Be,ai as Ie,az as O,ag as te,Y as E,aP as Me,aQ as qe,aR as Oe,aB as W,aC as oe,aD as se,aw as G,V as he,aS as ke,aT as je,aE as ie,aU as Ke,q as Pe,Z as We}from"./index-8Z_lsMAG.js";import{e as re,b as ue,c as de,t as He,g as ce,h as pe,A as Je,v as Ge,i as Qe,f as Xe}from"./auths-CZSByJgv.js";const ze=Symbol("elPaginationKey"),Ye=H({disabled:Boolean,currentPage:{type:Number,default:1},prevText:{type:String},prevIcon:{type:ne}}),Ze={click:e=>e instanceof MouseEvent},ea=D({name:"ElPaginationPrev"}),aa=D({...ea,props:Ye,emits:Ze,setup(e){const m=e,{t:n}=J(),f=U(()=>m.disabled||m.currentPage<=1);return(i,g)=>(C(),$("button",{type:"button",class:"btn-prev",disabled:d(f),"aria-label":i.prevText||d(n)("el.pagination.prev"),"aria-disabled":d(f),onClick:b=>i.$emit("click",b)},[i.prevText?(C(),$("span",{key:0},K(i.prevText),1)):(C(),T(d(ve),{key:1},{default:u(()=>[(C(),T(_e(i.prevIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var ta=Z(aa,[["__file","prev.vue"]]);const na=H({disabled:Boolean,currentPage:{type:Number,default:1},pageCount:{type:Number,default:50},nextText:{type:String},nextIcon:{type:ne}}),la=D({name:"ElPaginationNext"}),oa=D({...la,props:na,emits:["click"],setup(e){const m=e,{t:n}=J(),f=U(()=>m.disabled||m.currentPage===m.pageCount||m.pageCount===0);return(i,g)=>(C(),$("button",{type:"button",class:"btn-next",disabled:d(f),"aria-label":i.nextText||d(n)("el.pagination.next"),"aria-disabled":d(f),onClick:b=>i.$emit("click",b)},[i.nextText?(C(),$("span",{key:0},K(i.nextText),1)):(C(),T(d(ve),{key:1},{default:u(()=>[(C(),T(_e(i.nextIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var sa=Z(oa,[["__file","next.vue"]]);const me=()=>xe(ze,{}),ia=H({pageSize:{type:Number,required:!0},pageSizes:{type:be(Array),default:()=>ye([10,20,30,40,50,100])},popperClass:{type:String},disabled:Boolean,teleported:Boolean,size:{type:String,values:Ce}}),ra=D({name:"ElPaginationSizes"}),ua=D({...ra,props:ia,emits:["page-size-change"],setup(e,{emit:m}){const n=e,{t:f}=J(),i=Q("pagination"),g=me(),b=h(n.pageSize);le(()=>n.pageSizes,(r,_)=>{if(!Se(r,_)&&Array.isArray(r)){const o=r.includes(n.pageSize)?n.pageSize:n.pageSizes[0];m("page-size-change",o)}}),le(()=>n.pageSize,r=>{b.value=r});const k=U(()=>n.pageSizes);function P(r){var _;r!==b.value&&(b.value=r,(_=g.handleSizeChange)==null||_.call(g,Number(r)))}return(r,_)=>(C(),$("span",{class:B(d(i).e("sizes"))},[t(d(ue),{"model-value":b.value,disabled:r.disabled,"popper-class":r.popperClass,size:r.size,teleported:r.teleported,"validate-event":!1,onChange:P},{default:u(()=>[(C(!0),$(X,null,Y(d(k),o=>(C(),T(d(re),{key:o,value:o,label:o+d(f)("el.pagination.pagesize")},null,8,["value","label"]))),128))]),_:1},8,["model-value","disabled","popper-class","size","teleported"])],2))}});var da=Z(ua,[["__file","sizes.vue"]]);const ca=H({size:{type:String,values:Ce}}),pa=D({name:"ElPaginationJumper"}),ma=D({...pa,props:ca,setup(e){const{t:m}=J(),n=Q("pagination"),{pageCount:f,disabled:i,currentPage:g,changeEvent:b}=me(),k=h(),P=U(()=>{var o;return(o=k.value)!=null?o:g==null?void 0:g.value});function r(o){k.value=o?+o:""}function _(o){o=Math.trunc(+o),b==null||b(o),k.value=void 0}return(o,l)=>(C(),$("span",{class:B(d(n).e("jump")),disabled:d(i)},[q("span",{class:B([d(n).e("goto")])},K(d(m)("el.pagination.goto")),3),t(d(ae),{size:o.size,class:B([d(n).e("editor"),d(n).is("in-pagination")]),min:1,max:d(f),disabled:d(i),"model-value":d(P),"validate-event":!1,"aria-label":d(m)("el.pagination.page"),type:"number","onUpdate:modelValue":r,onChange:_},null,8,["size","class","max","disabled","model-value","aria-label"]),q("span",{class:B([d(n).e("classifier")])},K(d(m)("el.pagination.pageClassifier")),3)],10,["disabled"]))}});var fa=Z(ma,[["__file","jumper.vue"]]);const ga=H({total:{type:Number,default:1e3}}),_a=D({name:"ElPaginationTotal"}),va=D({..._a,props:ga,setup(e){const{t:m}=J(),n=Q("pagination"),{disabled:f}=me();return(i,g)=>(C(),$("span",{class:B(d(n).e("total")),disabled:d(f)},K(d(m)("el.pagination.total",{total:i.total})),11,["disabled"]))}});var ba=Z(va,[["__file","total.vue"]]);const ya=H({currentPage:{type:Number,default:1},pageCount:{type:Number,required:!0},pagerCount:{type:Number,default:7},disabled:Boolean}),Ca=D({name:"ElPaginationPager"}),ha=D({...Ca,props:ya,emits:["change"],setup(e,{emit:m}){const n=e,f=Q("pager"),i=Q("icon"),{t:g}=J(),b=h(!1),k=h(!1),P=h(!1),r=h(!1),_=h(!1),o=h(!1),l=U(()=>{const a=n.pagerCount,y=(a-1)/2,s=Number(n.currentPage),R=Number(n.pageCount);let V=!1,L=!1;R>a&&(s>a-y&&(V=!0),s<R-y&&(L=!0));const I=[];if(V&&!L){const x=R-(a-2);for(let F=x;F<R;F++)I.push(F)}else if(!V&&L)for(let x=2;x<a;x++)I.push(x);else if(V&&L){const x=Math.floor(a/2)-1;for(let F=s-x;F<=s+x;F++)I.push(F)}else for(let x=2;x<R;x++)I.push(x);return I}),c=U(()=>["more","btn-quickprev",i.b(),f.is("disabled",n.disabled)]),p=U(()=>["more","btn-quicknext",i.b(),f.is("disabled",n.disabled)]),w=U(()=>n.disabled?-1:0);Ve(()=>{const a=(n.pagerCount-1)/2;b.value=!1,k.value=!1,n.pageCount>n.pagerCount&&(n.currentPage>n.pagerCount-a&&(b.value=!0),n.currentPage<n.pageCount-a&&(k.value=!0))});function z(a=!1){n.disabled||(a?P.value=!0:r.value=!0)}function N(a=!1){a?_.value=!0:o.value=!0}function S(a){const y=a.target;if(y.tagName.toLowerCase()==="li"&&Array.from(y.classList).includes("number")){const s=Number(y.textContent);s!==n.currentPage&&m("change",s)}else y.tagName.toLowerCase()==="li"&&Array.from(y.classList).includes("more")&&v(a)}function v(a){const y=a.target;if(y.tagName.toLowerCase()==="ul"||n.disabled)return;let s=Number(y.textContent);const R=n.pageCount,V=n.currentPage,L=n.pagerCount-2;y.className.includes("more")&&(y.className.includes("quickprev")?s=V-L:y.className.includes("quicknext")&&(s=V+L)),Number.isNaN(+s)||(s<1&&(s=1),s>R&&(s=R)),s!==V&&m("change",s)}return(a,y)=>(C(),$("ul",{class:B(d(f).b()),onClick:v,onKeyup:Re(S,["enter"])},[a.pageCount>0?(C(),$("li",{key:0,class:B([[d(f).is("active",a.currentPage===1),d(f).is("disabled",a.disabled)],"number"]),"aria-current":a.currentPage===1,"aria-label":d(g)("el.pagination.currentPage",{pager:1}),tabindex:d(w)}," 1 ",10,["aria-current","aria-label","tabindex"])):ee("v-if",!0),b.value?(C(),$("li",{key:1,class:B(d(c)),tabindex:d(w),"aria-label":d(g)("el.pagination.prevPages",{pager:a.pagerCount-2}),onMouseenter:s=>z(!0),onMouseleave:s=>P.value=!1,onFocus:s=>N(!0),onBlur:s=>_.value=!1},[(P.value||_.value)&&!a.disabled?(C(),T(d($e),{key:0})):(C(),T(d(fe),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):ee("v-if",!0),(C(!0),$(X,null,Y(d(l),s=>(C(),$("li",{key:s,class:B([[d(f).is("active",a.currentPage===s),d(f).is("disabled",a.disabled)],"number"]),"aria-current":a.currentPage===s,"aria-label":d(g)("el.pagination.currentPage",{pager:s}),tabindex:d(w)},K(s),11,["aria-current","aria-label","tabindex"]))),128)),k.value?(C(),$("li",{key:2,class:B(d(p)),tabindex:d(w),"aria-label":d(g)("el.pagination.nextPages",{pager:a.pagerCount-2}),onMouseenter:s=>z(),onMouseleave:s=>r.value=!1,onFocus:s=>N(),onBlur:s=>o.value=!1},[(r.value||o.value)&&!a.disabled?(C(),T(d(Ne),{key:0})):(C(),T(d(fe),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):ee("v-if",!0),a.pageCount>1?(C(),$("li",{key:3,class:B([[d(f).is("active",a.currentPage===a.pageCount),d(f).is("disabled",a.disabled)],"number"]),"aria-current":a.currentPage===a.pageCount,"aria-label":d(g)("el.pagination.currentPage",{pager:a.pageCount}),tabindex:d(w)},K(a.pageCount),11,["aria-current","aria-label","tabindex"])):ee("v-if",!0)],42,["onKeyup"]))}});var ka=Z(ha,[["__file","pager.vue"]]);const A=e=>typeof e!="number",Pa=H({pageSize:Number,defaultPageSize:Number,total:Number,pageCount:Number,pagerCount:{type:Number,validator:e=>M(e)&&Math.trunc(e)===e&&e>4&&e<22&&e%2===1,default:7},currentPage:Number,defaultCurrentPage:Number,layout:{type:String,default:["prev","pager","next","jumper","->","total"].join(", ")},pageSizes:{type:be(Array),default:()=>ye([10,20,30,40,50,100])},popperClass:{type:String,default:""},prevText:{type:String,default:""},prevIcon:{type:ne,default:()=>Le},nextText:{type:String,default:""},nextIcon:{type:ne,default:()=>Fe},teleported:{type:Boolean,default:!0},small:Boolean,size:Be,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean}),za={"update:current-page":e=>M(e),"update:page-size":e=>M(e),"size-change":e=>M(e),change:(e,m)=>M(e)&&M(m),"current-change":e=>M(e),"prev-click":e=>M(e),"next-click":e=>M(e)},ge="ElPagination";var wa=D({name:ge,props:Pa,emits:za,setup(e,{emit:m,slots:n}){const{t:f}=J(),i=Q("pagination"),g=De().vnode.props||{},b=U(()=>{var a;return e.small?"small":(a=e.size)!=null?a:Te().value});Ee({from:"small",replacement:"size",version:"3.0.0",scope:"el-pagination",ref:"https://element-plus.org/zh-CN/component/pagination.html"},U(()=>!!e.small));const k="onUpdate:currentPage"in g||"onUpdate:current-page"in g||"onCurrentChange"in g,P="onUpdate:pageSize"in g||"onUpdate:page-size"in g||"onSizeChange"in g,r=U(()=>{if(A(e.total)&&A(e.pageCount)||!A(e.currentPage)&&!k)return!1;if(e.layout.includes("sizes")){if(A(e.pageCount)){if(!A(e.total)&&!A(e.pageSize)&&!P)return!1}else if(!P)return!1}return!0}),_=h(A(e.defaultPageSize)?10:e.defaultPageSize),o=h(A(e.defaultCurrentPage)?1:e.defaultCurrentPage),l=U({get(){return A(e.pageSize)?_.value:e.pageSize},set(a){A(e.pageSize)&&(_.value=a),P&&(m("update:page-size",a),m("size-change",a))}}),c=U(()=>{let a=0;return A(e.pageCount)?A(e.total)||(a=Math.max(1,Math.ceil(e.total/l.value))):a=e.pageCount,a}),p=U({get(){return A(e.currentPage)?o.value:e.currentPage},set(a){let y=a;a<1?y=1:a>c.value&&(y=c.value),A(e.currentPage)&&(o.value=y),k&&(m("update:current-page",y),m("current-change",y))}});le(c,a=>{p.value>a&&(p.value=a)}),le([p,l],a=>{m("change",...a)},{flush:"post"});function w(a){p.value=a}function z(a){l.value=a;const y=c.value;p.value>y&&(p.value=y)}function N(){e.disabled||(p.value-=1,m("prev-click",p.value))}function S(){e.disabled||(p.value+=1,m("next-click",p.value))}function v(a,y){a&&(a.props||(a.props={}),a.props.class=[a.props.class,y].join(" "))}return Ue(ze,{pageCount:c,disabled:U(()=>e.disabled),currentPage:p,changeEvent:w,handleSizeChange:z}),()=>{var a,y;if(!r.value)return Ae(ge,f("el.pagination.deprecationWarning")),null;if(!e.layout||e.hideOnSinglePage&&c.value<=1)return null;const s=[],R=[],V=j("div",{class:i.e("rightwrapper")},R),L={prev:j(ta,{disabled:e.disabled,currentPage:p.value,prevText:e.prevText,prevIcon:e.prevIcon,onClick:N}),jumper:j(fa,{size:b.value}),pager:j(ka,{currentPage:p.value,pageCount:c.value,pagerCount:e.pagerCount,onChange:w,disabled:e.disabled}),next:j(sa,{disabled:e.disabled,currentPage:p.value,pageCount:c.value,nextText:e.nextText,nextIcon:e.nextIcon,onClick:S}),sizes:j(da,{pageSize:l.value,pageSizes:e.pageSizes,popperClass:e.popperClass,disabled:e.disabled,teleported:e.teleported,size:b.value}),slot:(y=(a=n==null?void 0:n.default)==null?void 0:a.call(n))!=null?y:null,total:j(ba,{total:A(e.total)?0:e.total})},I=e.layout.split(",").map(F=>F.trim());let x=!1;return I.forEach(F=>{if(F==="->"){x=!0;return}x?R.push(L[F]):s.push(L[F])}),v(s[0],i.is("first")),v(s[s.length-1],i.is("last")),x&&R.length>0&&(v(R[0],i.is("first")),v(R[R.length-1],i.is("last")),s.push(V)),j("div",{class:[i.b(),i.is("background",e.background),i.m(b.value)]},s)}}});const xa=Ie(wa),we=(e,m)=>O({url:"/tenants/page-list",method:"post",data:{current:e,size:m}}),Sa=e=>O({url:"/tenants/add",method:"post",data:e}),Va=e=>O({url:"/tenants/delete",method:"post",data:e}),$a={class:"dialog-footer"},Na=D({__name:"UserFormDialog",emits:["submit"],setup(e,{expose:m,emit:n}){const f=n,i=()=>({id:void 0,name:"",password:"",tenant_id:void 0,role_ids:[]}),g=h(!1),b=h("新增用户"),k=h(!0),P=(S=!0,v)=>{g.value=!0,k.value=S,Object.assign(p,i()),S?(b.value="新增用户",z.value[0].required=!0):(b.value="修改用户",z.value[0].required=!1,Object.assign(p,{...v}),_(v==null?void 0:v.id)),setTimeout(()=>{var a;(a=c.value)==null||a.clearValidate()},100),l()},r=h(),_=async S=>{const{data:v}=await Me(S);Object.assign(p,{role_ids:v.data.selectedRoles}),r.value=v.data.allRoles.map(a=>({label:a.name,value:a.id}))},o=h([]),l=async()=>{if(o.value.length>0)return;const{data:S}=await we(1,1e3);o.value=S.data.records.map(v=>({label:v.name,value:v.id}))},c=h(),p=te(i()),w={name:[{required:!0,message:"名称不能为空",trigger:"blur"}],tenant_id:[{required:!0,message:"请选择所属租户",trigger:"change"}]},z=h([{required:!0,message:"密码不能为空",trigger:"blur"}]),N=async()=>{var a;if(!(await((a=c.value)==null?void 0:a.validate().catch(()=>Promise.resolve(!1)))??!1))return;let v;if(k.value)v=await qe({...p});else{const{id:y,tenant_id:s,role_ids:R,password:V}=p;v=await Oe({id:y,tenant_id:s,role_ids:R,password:V||void 0})}g.value=!1,f("submit",v.data),W.success("更新成功")};return m({initDialog:P}),(S,v)=>{const a=ae,y=oe,s=re,R=ue,V=se,L=G,I=de;return C(),T(I,{modelValue:g.value,"onUpdate:modelValue":v[5]||(v[5]=x=>g.value=x),title:b.value,width:"500"},{footer:u(()=>[q("div",$a,[t(L,{onClick:v[4]||(v[4]=x=>g.value=!1)},{default:u(()=>[E("取 消")]),_:1}),t(L,{type:"primary",onClick:N},{default:u(()=>[E("保 存")]),_:1})])]),default:u(()=>[t(V,{ref_key:"formRef",ref:c,model:p,rules:w,"label-width":"90px"},{default:u(()=>[t(y,{label:"用户名",prop:"name"},{default:u(()=>[t(a,{modelValue:p.name,"onUpdate:modelValue":v[0]||(v[0]=x=>p.name=x),disabled:!k.value},null,8,["modelValue","disabled"])]),_:1}),t(y,{label:"密码",prop:"password",rules:z.value},{default:u(()=>[t(a,{modelValue:p.password,"onUpdate:modelValue":v[1]||(v[1]=x=>p.password=x),type:"password","show-password":""},null,8,["modelValue"])]),_:1},8,["rules"]),t(y,{label:"所属租户",prop:"tenant_id"},{default:u(()=>[t(R,{modelValue:p.tenant_id,"onUpdate:modelValue":v[2]||(v[2]=x=>p.tenant_id=x)},{default:u(()=>[(C(!0),$(X,null,Y(o.value,x=>(C(),T(s,{key:x.value,label:x.label,value:x.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),k.value?ee("",!0):(C(),T(y,{key:0,label:"角色",prop:"role_ids"},{default:u(()=>[t(R,{modelValue:p.role_ids,"onUpdate:modelValue":v[3]||(v[3]=x=>p.role_ids=x),multiple:""},{default:u(()=>[(C(!0),$(X,null,Y(r.value,x=>(C(),T(s,{key:x.value,label:x.label,value:x.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}))]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Ra={class:"use-list-wrapper p-10"},Da={class:"table-top-btn mb-4"},Ta=D({__name:"Users",setup(e,{expose:m}){const n=h([]),f=async()=>{const r=await ke();n.value=r.data.data},i=async r=>{W.confirm("确定要删除该用户?").then(async _=>{_&&(await je(r),await f())})},g=h(),b=()=>{var r;(r=g.value)==null||r.initDialog(!0)},k=r=>{var c;const{id:_,tenant_id:o,name:l}=r;(c=g.value)==null||c.initDialog(!1,{id:_,tenant_id:o,name:l})},P=(r,_)=>{r.agent&&_.property!=="action"&&W.success(r.agent)};return he(()=>{f()}),m({loadUserList:f}),(r,_)=>{const o=G,l=ce,c=pe;return C(),$("div",Ra,[q("div",Da,[t(o,{type:"primary",onClick:b},{default:u(()=>[E("新增用户")]),_:1})]),t(c,{border:"",data:n.value,onRowClick:P},{default:u(()=>[t(l,{type:"index",label:"序号",align:"center"}),t(l,{label:"用户名",prop:"name"}),t(l,{label:"所属租户",prop:"tenant_name"}),t(l,{label:"最新登录时间",prop:"last_login_time",formatter:d(He)},null,8,["formatter"]),t(l,{label:"操作",width:"180",align:"center",prop:"action"},{default:u(({row:p})=>[t(o,{disabled:p.name==="system-super-user",type:"primary",size:"small",onClick:w=>k(p)},{default:u(()=>[E("修改用户")]),_:2},1032,["disabled","onClick"]),t(o,{disabled:p.name==="system-super-user",type:"danger",size:"small",onClick:w=>i(p.id)},{default:u(()=>[E("删除")]),_:2},1032,["disabled","onClick"])]),_:1})]),_:1},8,["data"]),t(Na,{ref_key:"userFormDialogRef",ref:g,onSubmit:f},null,512)])}}}),Ea=ie(Ta,[["__scopeId","data-v-41a47cf1"]]),Ua={class:"dialog-footer"},Aa=D({__name:"TenantFormDialog",emits:["submit"],setup(e,{expose:m,emit:n}){const f=n,i=h(!1),g=h("新增租户"),b=()=>{var o;i.value=!0,(o=k.value)==null||o.resetFields()},k=h(),P=te({name:"",remark:""}),r={name:[{required:!0,message:"名称不能为空",trigger:"blur"}]},_=async()=>{var l;(await((l=k.value)==null?void 0:l.validate().catch(()=>Promise.resolve(!1)))??!1)&&Sa({...P}).then(({data:c})=>{i.value=!1,f("submit",c.data)}).catch(c=>{console.error(c.toString())})};return m({initDialog:b}),(o,l)=>{const c=ae,p=oe,w=se,z=G,N=de;return C(),T(N,{modelValue:i.value,"onUpdate:modelValue":l[3]||(l[3]=S=>i.value=S),title:g.value,width:"500"},{footer:u(()=>[q("div",Ua,[t(z,{onClick:l[2]||(l[2]=S=>i.value=!1)},{default:u(()=>[E("取 消")]),_:1}),t(z,{type:"primary",onClick:_},{default:u(()=>[E("保 存")]),_:1})])]),default:u(()=>[t(w,{ref_key:"formRef",ref:k,model:P,rules:r,"label-width":"90px"},{default:u(()=>[t(p,{label:"租户名称",prop:"name"},{default:u(()=>[t(c,{modelValue:P.name,"onUpdate:modelValue":l[0]||(l[0]=S=>P.name=S)},null,8,["modelValue"])]),_:1}),t(p,{label:"备注",prop:"remark"},{default:u(()=>[t(c,{modelValue:P.remark,"onUpdate:modelValue":l[1]||(l[1]=S=>P.remark=S)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),La={class:"tenant-list-wrapper p-10"},Fa={class:"table-top-btn mb-4"},Ba=D({__name:"Tenants",setup(e,{expose:m}){const n=h([]),f=te({total:0,size:10,current:1}),i=async()=>{const{current:o,size:l}=f,{data:c}=await we(o,l),{records:p,total:w}=c.data;n.value=p,f.total=w},g=h(),b=()=>{var o;(o=g.value)==null||o.initDialog()},k=h([]),P=o=>{k.value=o.map(l=>l.id)},r=async()=>{Ke.confirm("确定要删除选中的租户?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",title:"提示"}).then(async()=>{await Va(k.value),await i()}).catch(()=>{})},_=()=>{i()};return he(()=>{}),m({loadTenantList:i}),(o,l)=>{const c=G,p=ce,w=pe,z=xa;return C(),$("div",La,[q("div",Fa,[t(c,{type:"primary",onClick:b},{default:u(()=>[E("新增租户")]),_:1}),t(c,{type:"danger",disabled:k.value.length===0,onClick:r},{default:u(()=>[E("删除租户")]),_:1},8,["disabled"])]),t(w,{border:"",data:n.value,onSelectionChange:P},{default:u(()=>[t(p,{type:"selection",align:"center"}),t(p,{type:"index",label:"序号",align:"center"}),t(p,{label:"租户名",prop:"name"}),t(p,{label:"备注",prop:"remark"})]),_:1},8,["data"]),t(z,{class:"mt-4",background:"",layout:"prev, pager, next, total",total:f.total,"page-size":f.size,"onUpdate:pageSize":l[0]||(l[0]=N=>f.size=N),"current-page":f.current,"onUpdate:currentPage":l[1]||(l[1]=N=>f.current=N),onSizeChange:i,onCurrentChange:i},null,8,["total","page-size","current-page"]),t(Aa,{ref_key:"tenantFormDialogRef",ref:g,onSubmit:_},null,512)])}}}),Ia=ie(Ba,[["__scopeId","data-v-98d3b433"]]),Ma=()=>O({url:"/roles/list",method:"post"}),qa=e=>O({url:"/roles/add",method:"post",data:e}),Oa=e=>O({url:"/roles/delete",method:"post",data:{id:e}}),ja=e=>O({url:"/roles/update",method:"post",data:e}),Ka=e=>O({url:"/roles/get-role-info",method:"post",data:{id:e}}),Wa=e=>O({url:"/roles/save-auth-user",method:"post",data:e}),Ha={class:"dialog-footer"},Ja=D({__name:"RoleFormDialog",emits:["submit"],setup(e,{expose:m,emit:n}){const f=n,i=()=>({name:"",remark:"",auths:[]}),g=h(!1),b=h(!0),k=U(()=>d(b)?"新增角色":"修改角色"),P=w=>{if(g.value=!0,_(),w){const{id:z,name:N,remark:S,auths:v}=w;Object.assign(l,{id:z,name:N,remark:S,auths:(v==null?void 0:v.split(","))??[]}),b.value=!1}else Object.assign(l,{...i(),id:void 0}),b.value=!0;Pe(()=>{var z;(z=o.value)==null||z.clearValidate()})},r=h([]),_=()=>{r.value=Object.entries({...Je}).map(([w,z])=>({label:w,value:z}))},o=h(),l=te(i()),c={name:[{required:!0,message:"角色名称不能为空",trigger:"blur"}]},p=async()=>{var s;if(!(await((s=o.value)==null?void 0:s.validate().catch(()=>Promise.resolve(!1)))??!1))return;const{name:z,remark:N,auths:S,id:v}=l,a=S.join();let y;b.value?y=await qa({name:z,remark:N,auths:a}):y=await ja({id:v,name:z,remark:N,auths:a}),g.value=!1,f("submit",y.data),W.success("创建角色成功")};return m({initDialog:P}),(w,z)=>{const N=ae,S=oe,v=re,a=ue,y=se,s=G,R=de;return C(),T(R,{modelValue:g.value,"onUpdate:modelValue":z[4]||(z[4]=V=>g.value=V),title:k.value,width:"500"},{footer:u(()=>[q("div",Ha,[t(s,{onClick:z[3]||(z[3]=V=>g.value=!1)},{default:u(()=>[E("取 消")]),_:1}),t(s,{type:"primary",onClick:p},{default:u(()=>[E("保 存")]),_:1})])]),default:u(()=>[t(y,{ref_key:"formRef",ref:o,model:l,rules:c,"label-width":"90px"},{default:u(()=>[t(S,{label:"角色名称",prop:"name"},{default:u(()=>[t(N,{modelValue:l.name,"onUpdate:modelValue":z[0]||(z[0]=V=>l.name=V)},null,8,["modelValue"])]),_:1}),t(S,{label:"备注",prop:"remark"},{default:u(()=>[t(N,{modelValue:l.remark,"onUpdate:modelValue":z[1]||(z[1]=V=>l.remark=V)},null,8,["modelValue"])]),_:1}),t(S,{label:"权限",prop:"auths"},{default:u(()=>[t(a,{modelValue:l.auths,"onUpdate:modelValue":z[2]||(z[2]=V=>l.auths=V),clearable:"",multiple:""},{default:u(()=>[(C(!0),$(X,null,Y(r.value,V=>(C(),T(v,{key:V.value,label:V.label,value:V.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Ga={class:"dialog-footer"},Qa=D({__name:"UserListDialog",setup(e,{expose:m}){const n=h(!1),f=h([]),i=h(!1),g=async l=>{n.value=!0,i.value=!0,await b(),await k(l),i.value=!1},b=async()=>{const l=await ke();f.value=l.data.data.map(c=>({label:c.name,value:c.id}))},k=async l=>{const{data:c}=await Ka(l);Object.assign(r,P(),{...c.data})},P=()=>({id:void 0,name:"",users:[]}),r=te(P()),_=h(),o=async()=>{var w;if(!(await((w=_.value)==null?void 0:w.validate().catch(()=>Promise.resolve(!1)))??!1))return;const{id:c,users:p}=r;await Wa({id:c,users:p}),n.value=!1,W.success("更新用户成功")};return m({initDialog:g}),(l,c)=>{const p=ae,w=oe,z=re,N=ue,S=se,v=G,a=de,y=Ge;return C(),T(a,{modelValue:n.value,"onUpdate:modelValue":c[3]||(c[3]=s=>n.value=s),title:"授权用户",width:"500"},{footer:u(()=>[q("div",Ga,[t(v,{onClick:c[2]||(c[2]=s=>n.value=!1)},{default:u(()=>[E("取 消")]),_:1}),t(v,{type:"primary",onClick:o},{default:u(()=>[E("保 存")]),_:1})])]),default:u(()=>[We((C(),T(S,{ref_key:"formRef",ref:_,model:r,"label-width":"90px"},{default:u(()=>[t(w,{label:"角色名称",prop:"name"},{default:u(()=>[t(p,{modelValue:r.name,"onUpdate:modelValue":c[0]||(c[0]=s=>r.name=s),disabled:""},null,8,["modelValue"])]),_:1}),t(w,{label:"用户",prop:"auths"},{default:u(()=>[t(N,{modelValue:r.users,"onUpdate:modelValue":c[1]||(c[1]=s=>r.users=s),clearable:"",multiple:""},{default:u(()=>[(C(!0),$(X,null,Y(f.value,s=>(C(),T(z,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[y,i.value]])]),_:1},8,["modelValue"])}}}),Xa={class:"role-list-wrapper p-10"},Ya={class:"table-top-btn mb-4"},Za=D({__name:"Roles",setup(e,{expose:m}){const n=h(),f=()=>{var _;(_=n.value)==null||_.initDialog()},i=_=>{var o;(o=n.value)==null||o.initDialog(_)},g=h([]),b=async()=>{const _=await Ma();g.value=_.data.data},k=async _=>{await W.confirm("确定要删除该角色?")&&(await Oa(_),await b(),W.success("删除成功"))},P=h(),r=_=>{var o;(o=P.value)==null||o.initDialog(_)};return m({loadRoleList:b}),(_,o)=>{const l=G,c=ce,p=pe;return C(),$("div",Xa,[q("div",Ya,[t(l,{type:"primary",onClick:f},{default:u(()=>[E("新增角色")]),_:1})]),t(p,{border:"",data:g.value},{default:u(()=>[t(c,{type:"index",label:"序号",align:"center"}),t(c,{label:"角色名",prop:"name"}),t(c,{label:"备注",prop:"remark"}),t(c,{label:"操作",width:"240",align:"center"},{default:u(({row:w})=>[t(l,{type:"primary",size:"small",onClick:z=>r(w.id)},{default:u(()=>[E("授权用户")]),_:2},1032,["onClick"]),t(l,{type:"primary",size:"small",onClick:z=>i(w)},{default:u(()=>[E("修改")]),_:2},1032,["onClick"]),t(l,{type:"danger",size:"small",onClick:z=>k(w.id)},{default:u(()=>[E("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(Ja,{ref_key:"roleFormDialogRef",ref:n,onSubmit:b},null,512),t(Qa,{ref_key:"userListDialogRef",ref:P},null,512)])}}}),et=ie(Za,[["__scopeId","data-v-2f32f3fe"]]),at={class:"system-config-wrapper"},tt=D({__name:"index",setup(e){const m=h("users"),n=h(),f=h(),i=h(),g=async()=>{var b,k,P;await Pe(),m.value==="users"&&await((b=n.value)==null?void 0:b.loadUserList()),m.value==="tenants"&&await((k=f.value)==null?void 0:k.loadTenantList()),m.value==="roles"&&await((P=i.value)==null?void 0:P.loadRoleList())};return(b,k)=>{const P=Xe,r=Qe;return C(),$("div",at,[t(r,{modelValue:m.value,"onUpdate:modelValue":k[0]||(k[0]=_=>m.value=_),class:"demo-tabs",onTabClick:g},{default:u(()=>[t(P,{label:"用户",name:"users"},{default:u(()=>[t(Ea,{ref_key:"usersRef",ref:n},null,512)]),_:1}),t(P,{label:"租户",name:"tenants"},{default:u(()=>[t(Ia,{ref_key:"tenantsRef",ref:f},null,512)]),_:1}),t(P,{label:"角色",name:"roles"},{default:u(()=>[t(et,{ref_key:"rolesRef",ref:i},null,512)]),_:1})]),_:1},8,["modelValue"])])}}}),ot=ie(tt,[["__scopeId","data-v-d813f3df"]]);export{ot as default};
