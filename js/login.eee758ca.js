"use strict";(self["webpackChunkweb001"]=self["webpackChunkweb001"]||[]).push([[535],{68687:function(e,o,t){t.r(o),t.d(o,{default:function(){return f}});var r=function(){var e=this,o=e._self._c,t=e._self._setupProxy;return o("div",{staticClass:"position-login"},[t.isShowLogin?o("div",{staticClass:"position-login-bg"},[o("div",{staticClass:"position-login-bg-box"},[o("div",{staticClass:"position-login-bg-box-left"}),o("div",{staticClass:"position-login-bg-box-right"},[o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loginLoading,expression:"loginLoading"}],staticClass:"position-login-bg-box-right-form"},[t.showYzmImage?e._e():o("FormWrapper",{ref:"loginRef",attrs:{model:t.loginForm,rules:t.formRules,wrap:"",labelWidth:"0px",bgc:!1}},[o("FormItemWrapper",{attrs:{span:24,prop:"userName"}},[o("JtInput",{attrs:{"prefix-icon":"el-icon-user",placeholder:"请输入用户名"},model:{value:t.loginForm.userName,callback:function(o){e.$set(t.loginForm,"userName",o)},expression:"loginForm.userName"}})],1),o("FormItemWrapper",{attrs:{span:24,prop:"passWord"}},[o("JtInput",{attrs:{"prefix-icon":"el-icon-unlock",type:"password",placeholder:"请输入密码","show-password":""},model:{value:t.loginForm.passWord,callback:function(o){e.$set(t.loginForm,"passWord",o)},expression:"loginForm.passWord"}})],1),o("FormItemWrapper",{attrs:{span:24}},[o(t.JtButton,{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:t.loginAction}},[e._v("登录")])],1)],1)],1)])])]):e._e()])},s=[],n=t(20144);const i=()=>{const e=(0,n.getCurrentInstance)();if(e)return e.proxy.$router};let a;const l=()=>{const e=(0,n.getCurrentInstance)();if(!e)return;const o=i();return a||(a=(0,n.reactive)({...e.proxy.$route}),o.afterEach((e=>Object.assign(a,e)))),a};var c=t(39954),u=(t(57658),t(76182)),p=t(49998),g={__name:"login",setup(e){var o;const t=(0,u.L)(),r=i(),s=l(),a="/layout/home",g=(0,n.reactive)({userName:"",passWord:"",validCode:"",deviceId:Math.random().toString(16).slice(-12),grant_type:"password_code"}),d=(0,n.ref)(!0),m=(0,n.ref)(""),v=async()=>{const e=await m.value.validate().catch((()=>{}));if(!e)return!1;const{state:o}=s.query;w.value=!1;const n={...g};d.value=!0;const i=await t.login(n);d.value=!1,i?r.push(o||a):t.removeUserinfo()},f=(0,n.reactive)({userName:[{required:!0,message:"请输入用户名",trigger:"blur"}],passWord:[{required:!0,message:"请输入密码",trigger:"blur"}]}),h=null===(o=t.tokenInfo)||void 0===o?void 0:o.access_token,w=(0,n.ref)(!1);(0,n.watch)((()=>g.validCode),(e=>{4===e.length&&v()}));const[b,x]=(0,c.e)(!0),y=async()=>{d.value=!0,x(!1);const{code:e,state:o}=s.query;if(e){const s=window.location.protocol,n=window.location.host,i=s+"//"+n+"/",l=await t.ssoLogin(e,i);if(l)return void r.push(o||a);t.removeUserinfo()}else h&&r.push(o||a);d.value=!1,setTimeout((()=>x(!0)),200)};return(0,n.nextTick)(y),{__sfc:!0,userStore:t,router:r,route:s,redirect:a,loginForm:g,loginLoading:d,loginRef:m,loginAction:v,formRules:f,token:h,showYzmImage:w,isShowLogin:b,setShowLogin:x,getTokenByCode:y,JtButton:p.Z}}},d=g,m=t(1001),v=(0,m.Z)(d,r,s,!1,null,"22931149",null),f=v.exports},39954:function(e,o,t){t.d(o,{e:function(){return s}});var r=t(20144);const s=(e=null)=>{const o=(0,r.ref)(e),t=e=>{o.value=e};return[o,t]}}}]);